import{renderCell}from"./renderTable.js";import{splitArray}from"./splitArray.js";function editTableData(e){const l=document.querySelector("table"),r=document.querySelector(".form-wrapper"),a=r.querySelectorAll("input"),i=r.querySelector("textarea"),t=r.querySelector(".btn-edit"),n=r.querySelector(".btn-close");let s;l.addEventListener("click",function(e){const t=e.target.closest(".data-row");s=t,t&&l.contains(t)&&(r.style.cssText=`display: block;  top: ${t.offsetTop}px; left: ${t.offsetWidth+20}px;`,r.onmousedown=function(e){let l=e.clientX-r.getBoundingClientRect().left,n=e.clientY-r.getBoundingClientRect().top;function t(e,t){r.style.left=e-l+"px",r.style.top=t-n+"px"}function o(e){t(e.pageX,e.pageY)}t(e.pageX,e.pageY),document.addEventListener("mousemove",o),r.onmouseup=function(){document.removeEventListener("mousemove",o),r.onmouseup=null}},r.ondragstart=function(){return!1},a[0].value=t.cells[0].innerHTML,a[1].value=t.cells[1].innerHTML,i.value=t.cells[2].innerHTML.slice(0,t.cells[2].innerHTML.length-3),a[2].value=t.cells[3].firstChild.style.cssText.replace("fill:","").slice(0,-1).split(" ").join(""))}),t.addEventListener("click",()=>{const e=JSON.parse(localStorage.getItem("jsonData"));var t=splitArray(e.JSON).length;const n={id:s.id,name:{firstName:a[0].value,lastName:a[1].value},phone:null,about:i.value,eyeColor:a[2].value};let o=0;e.JSON.forEach((e,t,l)=>{e.id===s.id&&(l.splice(t,1,n),o=t+1)}),localStorage.setItem(e,JSON.stringify(e)),r.style="",renderCell(e,Math.ceil(o/(e.JSON.length/t)))}),n.addEventListener("click",()=>r.style="")}export{editTableData};